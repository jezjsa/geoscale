# Supabase Database Schema

This directory contains the database schema for GeoScale.

## Setup Instructions

1. **Create a Supabase Project**
   - Go to [supabase.com](https://supabase.com)
   - Create a new project
   - Note your project URL and anon key

2. **Run the Schema**
   - Go to your Supabase project dashboard
   - Navigate to SQL Editor
   - Copy and paste the contents of `schema.sql`
   - Execute the SQL

3. **Set up Environment Variables**
   - Copy `.env.example` to `.env`
   - Add your Supabase URL and anon key:
     ```
     VITE_SUPABASE_URL=your_project_url
     VITE_SUPABASE_ANON_KEY=your_anon_key
     ```

## Database Tables

- **users** - User profiles linked to Supabase auth
- **agencies** - Agency accounts (for Agency/Agency Plus plans)
- **projects** - WordPress projects with connection details
- **project_locations** - Discovered nearby towns/cities
- **keyword_variations** - Selected keyword variations from DataForSEO
- **location_keywords** - Combined location + keyword matrix
- **generated_pages** - AI-generated landing page content
- **usage_tracking** - Track usage limits per user
- **api_logs** - Debug logs for API calls

## Row Level Security (RLS)

All tables have RLS enabled with policies that ensure:
- Users can only access their own data
- Agency owners can manage their agency's data
- Proper isolation between users and projects

## API Keys

WordPress API keys are stored in the `projects` table. These are generated by the SaaS app and copied into the WordPress plugin settings.

Sensitive API keys (Google, DataForSEO, OpenAI, Stripe secret keys) are stored in Supabase Secrets and accessed via Edge Functions.

